# 微信公众号内容生成器 v3.8（精简版）

**版本**：v3.8
**更新日期**：2026-01-29
**重大变更**：按照四层机制精简 SKILL.md，详细内容移至 knowledge/

---

## 🚨 静默执行协议

**执行规则：**
- ❌ 禁止请求确认以继续
- ✅ 必须一次性生成完整输出（文案 + 配图 + 推送）
- ✅ 数据缺失时使用默认值或自动搜索

---

## 📋 核心功能

1. 搜索/加载知识文档
2. 匹配相关商品（从商品库智能匹配1-3个）
3. 生成内容（标题 + 摘要 + 正文 + CTA）
4. 生成配图（根据格式选择比例）
5. 保存文件到专属文件夹
6. 推送至微信公众号草稿箱

---

## 🆕 [必需] 内容格式参数

### 两种格式对照

| 格式 | 触发词 | 配图比例 | 配图数量 |
|-----|-------|---------|---------|
| **长文** | \"公众号长文\"、\"订阅号长文\" | 横版（封面2.35:1，正文16:9） | 1封面+3正文 |
| **图文** | \"公众号图文\"、\"订阅号图文\" | 竖版（3:4，1080×1440） | 1封面+5正文 |

**默认**：未指定时默认生成长文（横版）

---

## 📚 [必需] 订阅号图文格式库

**当用户说\"订阅号图文\"时，必须询问格式：**

1. **诗意金句治愈哲理** - 现代小诗体，触动人心
2. **实用干货体** - 结构化知识点，清晰实用
3. **故事叙事体** - 情节化叙述，画面感强
4. **问答互动体** - 问答结构，对话感强

**详细格式说明**：参考 `knowledge/subscription-copywriting.md`

---

## 🎯 [必需] 双号运营策略

### 订阅号 vs 服务号定位

| 维度 | 订阅号 | 服务号 |
|------|--------|--------|
| **内容类型** | 干货知识、情感共鸣 | 产品介绍、服务说明 |
| **商品植入** | 软植入（1-2段） | 可直接推荐（2-3段） |
| **CTA** | 引导关注、评论 | 引导购买、咨询 |

**详细策略**：参考 `knowledge/wechat_strategy_handbook.md`

---

## 🖼️ [必需] 配图规范

### 核心要求

**长文格式**：
- 封面：2.35:1（900×383px）
- 正文：16:9（900×506px）
- 数量：1封面 + 3正文

**图文格式**：
- 封面：3:4（1080×1440px）
- 正文：3:4（1080×1440px）
- 数量：1封面 + 5正文

### 配图风格规则

**封面图**：按照通篇文档的风格选择
**正文配图**：按照对应段落内容选择风格

**详细指南**：参考 `knowledge/wechat-image-prompt-guide.md`

---

## 🔄 执行流程

### Step 1: 解析输入 [必需]
- 识别内容格式（长文/图文）
- 识别平台类型（订阅号/服务号）
- 如果是订阅号图文，询问格式选择

### Step 2: 知识搜索 [必需]
- 使用 WebSearch 搜索相关知识
- 搜索本地知识库
- 整合网络和本地知识

### Step 3: 商品匹配 [必需]
- 调用 product-catalog 匹配相关商品
- 选择1-3个商品用于软植入

### Step 4: 生成内容 [必需]
- 生成标题、摘要、正文
- 根据平台类型调整商品植入度
- 生成 CTA

### Step 5: 生成配图 [必需]
- 根据格式选择配图比例
- 封面按通篇风格，正文按段落内容
- 调用 generate_wechat_images.py

### Step 6: 保存文件 [必需]
- 创建专属文件夹
- 保存 Markdown 文档
- 保存所有配图

### Step 7: 推送草稿箱 [必需]
- 调用 wechat_publish.py
- 推送至微信公众号草稿箱

**检查点**：
- [ ] 已执行知识搜索
- [ ] 已匹配商品
- [ ] 已生成配图
- [ ] 已推送草稿箱

---

## 📦 输出结构

```
/Users/dj/Desktop/全域自媒体运营/内容发布/发布记录/2026/订阅号/
└── 2026-01-29_选题名称/
    ├── 2026-01-29_选题名称.md
    ├── cover.png
    ├── 01.png, 02.png, 03.png
    └── data.json
```

---

## 📚 详细文档

- **格式库详细说明**：`knowledge/subscription-copywriting.md`
- **配图生成指南**：`knowledge/wechat-image-prompt-guide.md`
- **运营策略手册**：`knowledge/wechat_strategy_handbook.md`
- **CTA 模板库**：`knowledge/cta-templates.md`
- **商品植入指南**：`knowledge/service-product-linking.md`

---

## 🔧 依赖

- `product-catalog` (Skill) - 商品匹配
- `compliance-checker` (Skill) - 违禁词检查
- `WebSearch` - 知识搜索
- `scripts/generate_wechat_images.py` - 配图生成
- `scripts/wechat_publish.py` - 推送草稿箱

---

**版本历史**：
- v3.8 (2026-01-29): 按照四层机制精简 SKILL.md
- v3.7 (2026-01-23): 新增订阅号图文格式库
- v3.3 (2026-01-15): 新增内容格式参数
