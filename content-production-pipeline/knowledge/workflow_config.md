# å·¥ä½œæµé…ç½®æŒ‡å—

## æ‰§è¡Œç­–ç•¥

### ä¸²è¡Œ vs å¹¶è¡Œ

**å½“å‰ç­–ç•¥ï¼šä¸²è¡Œæ‰§è¡Œ**
- åŸå› ï¼šé¿å… API é™æµ
- ä¼˜ç‚¹ï¼šç¨³å®šå¯é 
- ç¼ºç‚¹ï¼šæ‰§è¡Œæ—¶é—´è¾ƒé•¿

**æœªæ¥ä¼˜åŒ–ï¼šæ™ºèƒ½å¹¶å‘**
- å›¾ç‰‡ç”Ÿæˆå¯å¹¶å‘ï¼ˆåŒä¸€é€‰é¢˜å†…ï¼‰
- ä¸åŒå¹³å°å¯å¹¶å‘ï¼ˆå°çº¢ä¹¦ + å…¬ä¼—å·ï¼‰
- éœ€è¦ API é…é¢ç®¡ç†

## é€‰é¢˜ç­›é€‰è§„åˆ™

### å°çº¢ä¹¦é€‰é¢˜ï¼ˆå…¨éƒ¨å¤„ç†ï¼‰
- æ‰€æœ‰é€‰é¢˜ç±»å‹éƒ½é€‚åˆ
- ä¼˜å…ˆçº§ï¼šåœºæ™¯ç—›ç‚¹ > æ–°æ‰‹é¿å‘ > å­£èŠ‚æ—¶ä»¤ > é€ç¤¼æ¨è > å…»æŠ¤çŸ¥è¯†

### å…¬ä¼—å·é€‰é¢˜ï¼ˆæ™ºèƒ½ç­›é€‰ï¼‰
```python
def filter_for_wechat(topics):
    """
    ç­›é€‰é€‚åˆå…¬ä¼—å·çš„é€‰é¢˜
    """
    filtered = []
    for topic in topics:
        # ä¼˜å…ˆåœºæ™¯ç—›ç‚¹ç±»
        if topic.type == "åœºæ™¯ç—›ç‚¹":
            filtered.append(topic)
        # é¿å…å…»æŠ¤çŸ¥è¯†ç±»ï¼ˆè½¬åŒ–ç‡ä½ï¼‰
        elif topic.type == "å…»æŠ¤çŸ¥è¯†":
            continue
        # å…¶ä»–ç±»å‹é€‚åº¦é€‰æ‹©
        elif len(filtered) < 5:
            filtered.append(topic)

    return filtered[:5]  # æœ€å¤š5ä¸ª
```

### è§†é¢‘é€‰é¢˜ï¼ˆæ™ºèƒ½ç­›é€‰ï¼‰
```python
def filter_for_video(topics):
    """
    ç­›é€‰é€‚åˆè§†é¢‘çš„é€‰é¢˜
    """
    filtered = []
    for topic in topics:
        # ä¼˜å…ˆæ•™ç¨‹ç±»ã€åœºæ™¯ç±»
        if topic.type in ["æ–°æ‰‹é¿å‘", "åœºæ™¯ç—›ç‚¹"]:
            filtered.append(topic)
        # é¿å…çº¯æ–‡å­—ç±»
        elif topic.type == "å…»æŠ¤çŸ¥è¯†" and "æ­¥éª¤" in topic.title:
            filtered.append(topic)

    return filtered[:3]  # æœ€å¤š3ä¸ª
```

## é”™è¯¯å¤„ç†ç­–ç•¥

### é”™è¯¯åˆ†ç±»

**è‡´å‘½é”™è¯¯ï¼ˆç»ˆæ­¢æµæ°´çº¿ï¼‰ï¼š**
- é€‰é¢˜å‘ç°å¤±è´¥
- å•†å“åº“æ— æ³•è®¿é—®
- è¾“å‡ºç›®å½•æ— æ³•åˆ›å»º

**éè‡´å‘½é”™è¯¯ï¼ˆè®°å½•å¹¶ç»§ç»­ï¼‰ï¼š**
- å•ä¸ªå†…å®¹ç”Ÿæˆå¤±è´¥
- å›¾ç‰‡ç”Ÿæˆå¤±è´¥ï¼ˆä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆï¼‰
- æ¨é€è‰ç¨¿ç®±å¤±è´¥ï¼ˆæ–‡ä»¶å·²ä¿å­˜ï¼‰

### é‡è¯•æœºåˆ¶

```python
MAX_RETRIES = 3
RETRY_DELAY = 5  # ç§’

def retry_on_failure(func, *args, **kwargs):
    """
    å¤±è´¥é‡è¯•è£…é¥°å™¨
    """
    for attempt in range(MAX_RETRIES):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            if attempt < MAX_RETRIES - 1:
                print(f"âš ï¸ å¤±è´¥ï¼Œ{RETRY_DELAY}ç§’åé‡è¯•... ({attempt+1}/{MAX_RETRIES})")
                time.sleep(RETRY_DELAY)
            else:
                print(f"âŒ é‡è¯•{MAX_RETRIES}æ¬¡åä»å¤±è´¥: {e}")
                raise
```

## è¿›åº¦è¿½è¸ª

### TodoWrite ä½¿ç”¨è§„èŒƒ

```python
# åˆå§‹åŒ–ä»»åŠ¡åˆ—è¡¨
todos = [
    {"content": "é€‰é¢˜å‘ç°", "status": "pending", "activeForm": "æ­£åœ¨å‘ç°é€‰é¢˜"},
    {"content": "å°çº¢ä¹¦å†…å®¹ç”Ÿæˆï¼ˆ0/10ï¼‰", "status": "pending", "activeForm": "æ­£åœ¨ç”Ÿæˆå°çº¢ä¹¦å†…å®¹"},
    {"content": "å…¬ä¼—å·å†…å®¹ç”Ÿæˆï¼ˆ0/5ï¼‰", "status": "pending", "activeForm": "æ­£åœ¨ç”Ÿæˆå…¬ä¼—å·å†…å®¹"},
    {"content": "ç”Ÿæˆæ‰§è¡ŒæŠ¥å‘Š", "status": "pending", "activeForm": "æ­£åœ¨ç”Ÿæˆæ‰§è¡ŒæŠ¥å‘Š"}
]

# æ›´æ–°è¿›åº¦
def update_progress(phase, current, total):
    """
    æ›´æ–°ä»»åŠ¡è¿›åº¦
    """
    todos[phase]["content"] = f"{phase_name}ï¼ˆ{current}/{total}ï¼‰"
    if current == total:
        todos[phase]["status"] = "completed"
    else:
        todos[phase]["status"] = "in_progress"
```

## æ•°æ®ä¼ é€’

### é€‰é¢˜æ•°æ®ç»“æ„

```python
{
    "topic_id": "001",
    "title": "å®¢å…å…‰çº¿ä¸å¥½ï¼Ÿè¿™5ç§è€é˜´ç»¿æ¤æœ€é€‚åˆä½ ",
    "type": "åœºæ™¯ç—›ç‚¹",
    "keywords": ["å®¢å…", "è€é˜´", "ç»¿æ¤"],
    "products": [
        {
            "name": "è™çš®å…°",
            "price": 29.9,
            "features": ["è€é˜´", "å¥½å…»"]
        }
    ],
    "platforms": {
        "xiaohongshu": true,
        "wechat": true,
        "video": false
    }
}
```

### ç”Ÿæˆç»“æœç»“æ„

```python
{
    "topic_id": "001",
    "status": "success",
    "outputs": {
        "xiaohongshu": {
            "folder": "/path/to/folder",
            "files": {
                "text": "æ–‡æ¡ˆ.md",
                "cover": "å°é¢.png",
                "images": ["é…å›¾_01.png", ...]
            }
        },
        "wechat": {
            "folder": "/path/to/folder",
            "draft_id": "12345"
        }
    },
    "errors": []
}
```

## æ‰§è¡ŒæŠ¥å‘Šæ¨¡æ¿

```markdown
# å†…å®¹ç”Ÿäº§æµæ°´çº¿æ‰§è¡ŒæŠ¥å‘Š

**æ‰§è¡Œæ—¶é—´ï¼š** {timestamp}
**è¡Œä¸šå…³é”®è¯ï¼š** {keyword}
**æ‰§è¡Œæ¨¡å¼ï¼š** {mode}

## é€‰é¢˜å‘ç°
{status} æˆåŠŸç”Ÿæˆ {count} ä¸ªé€‰é¢˜
ğŸ“ æŠ¥å‘Šè·¯å¾„ï¼š{path}

## å°çº¢ä¹¦å†…å®¹ç”Ÿæˆ
âœ… æˆåŠŸï¼š{success_count} ä¸ª
âŒ å¤±è´¥ï¼š{fail_count} ä¸ª
ğŸ“ è¾“å‡ºç›®å½•ï¼š{output_dir}

### æˆåŠŸåˆ—è¡¨
{success_list}

### å¤±è´¥åˆ—è¡¨
{fail_list}

## å…¬ä¼—å·å†…å®¹ç”Ÿæˆ
{wechat_report}

## è§†é¢‘è„šæœ¬ç”Ÿæˆ
{video_report}

## æ€»ç»“
- æ€»è€—æ—¶ï¼š{duration}
- æˆåŠŸç‡ï¼š{success_rate}%
- ç”Ÿæˆæ–‡ä»¶ï¼š{file_count} ä¸ª
```

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥

**å•†å“åº“ç¼“å­˜ï¼š**
- é¦–æ¬¡åŠ è½½åç¼“å­˜åˆ°å†…å­˜
- é¿å…é‡å¤è¯»å– Excel

**é€‰é¢˜æŠ¥å‘Šç¼“å­˜ï¼š**
- è§£æåç¼“å­˜é€‰é¢˜åˆ—è¡¨
- é¿å…é‡å¤è§£æ Markdown

### å¹¶å‘ä¼˜åŒ–ï¼ˆæœªæ¥ï¼‰

**å¯å¹¶å‘çš„éƒ¨åˆ†ï¼š**
1. åŒä¸€é€‰é¢˜å†…çš„å¤šå¼ å›¾ç‰‡ç”Ÿæˆ
2. ä¸åŒå¹³å°çš„å†…å®¹ç”Ÿæˆï¼ˆå°çº¢ä¹¦ + å…¬ä¼—å·ï¼‰
3. ä¸åŒé€‰é¢˜çš„å†…å®¹ç”Ÿæˆï¼ˆéœ€è¦ API é…é¢ç®¡ç†ï¼‰

**ä¸å¯å¹¶å‘çš„éƒ¨åˆ†ï¼š**
1. é€‰é¢˜å‘ç°ï¼ˆå•æ¬¡è°ƒç”¨ï¼‰
2. æ–‡ä»¶å†™å…¥ï¼ˆé¿å…å†²çªï¼‰

## é…ç½®å‚æ•°

```python
# é»˜è®¤é…ç½®
DEFAULT_CONFIG = {
    "platforms": ["xiaohongshu"],  # é»˜è®¤åªç”Ÿæˆå°çº¢ä¹¦
    "topic_count": 10,              # é»˜è®¤å¤„ç†10ä¸ªé€‰é¢˜
    "max_retries": 3,               # æœ€å¤§é‡è¯•æ¬¡æ•°
    "retry_delay": 5,               # é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰
    "timeout": 600,                 # å•ä¸ªé€‰é¢˜è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    "enable_cache": True,           # å¯ç”¨ç¼“å­˜
    "log_level": "INFO"             # æ—¥å¿—çº§åˆ«
}

# å¹³å°é…ç½®
PLATFORM_CONFIG = {
    "xiaohongshu": {
        "enabled": True,
        "max_topics": 10
    },
    "wechat": {
        "enabled": False,
        "max_topics": 5,
        "filter_types": ["åœºæ™¯ç—›ç‚¹", "æ–°æ‰‹é¿å‘", "å­£èŠ‚æ—¶ä»¤"]
    },
    "video": {
        "enabled": False,
        "max_topics": 3,
        "filter_types": ["æ–°æ‰‹é¿å‘", "åœºæ™¯ç—›ç‚¹"]
    }
}
```

## ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—çº§åˆ«

- **DEBUG**: è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
- **INFO**: ä¸€èˆ¬ä¿¡æ¯ï¼ˆé»˜è®¤ï¼‰
- **WARNING**: è­¦å‘Šä¿¡æ¯
- **ERROR**: é”™è¯¯ä¿¡æ¯

### å…³é”®æŒ‡æ ‡

- æ‰§è¡Œæ—¶é—´
- æˆåŠŸç‡
- API è°ƒç”¨æ¬¡æ•°
- æ–‡ä»¶ç”Ÿæˆæ•°é‡
- é”™è¯¯ç±»å‹åˆ†å¸ƒ
