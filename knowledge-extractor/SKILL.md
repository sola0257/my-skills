---
name: knowledge-extractor
description: |
  智能知识文档整理与方法论提取工具。当用户需要整理文件夹中的知识文档、提取核心方法论、形成分类汇总时使用此技能。
  
  触发场景：
  - "整理知识文档 [文件夹路径]"
  - "提取方法论"
  - "生成知识库汇总"
  - "帮我整理一下这个文件夹的知识"
  - "把这些文档的方法论提取出来"
  
  核心能力：
  1. 多格式文件读取（.html .md .txt .pdf .doc/.docx 图片）
  2. 增量处理机制（避免重复处理已处理文档）
  3. 智能分类推断（自动识别知识领域，匹配分类模板）
  4. 深度知识提取（方法论框架、底层逻辑、跨平台适用性）
  5. 多维度分类汇总（内容形式/平台特性/通用逻辑）
  
  不适用于：单个文件的简单阅读、非知识整理类请求
license: MIT
---

# 知识文档整理与方法论提取 (Knowledge Extractor)

## 🚨 静默执行协议 (CRITICAL - READ FIRST)

**执行本技能时，必须遵守以下原则：**

1. **禁止中途确认**：不要请求用户确认是否继续，一口气完成全部处理
2. **完整输出**：一次性生成完整的汇总文档，不要分段询问
3. **静默错误处理**：遇到空文件、无法读取的文件时，记录日志并继续，不要停下来询问
4. **使用默认值**：当分类不确定时，默认归入"待分类"节点
5. **自动推断**：当无法确定领域时，使用"通用知识"模板

---

## 一、执行流程概览

```
┌─────────────────────────────────────────────────────────────────┐
│ 1. 接收用户指定的文件夹路径                                        │
├─────────────────────────────────────────────────────────────────┤
│ 2. 扫描文件夹，获取所有支持格式的文件列表                            │
├─────────────────────────────────────────────────────────────────┤
│ 3. 读取 .processed_files.json 进行增量判断                         │
│    ├── 新文件 → 加入处理队列                                       │
│    ├── 已修改文件 → 加入处理队列                                    │
│    └── 未变化文件 → 跳过                                           │
├─────────────────────────────────────────────────────────────────┤
│ 4. 确定分类模板                                                    │
│    ├── 检测已有汇总文件 → 沿用其结构                                 │
│    ├── 用户指定模板 → 使用指定模板                                   │
│    └── 均无 → 智能推断领域并生成分类结构                              │
├─────────────────────────────────────────────────────────────────┤
│ 5. 对每个待处理文件：                                               │
│    a. 根据文件格式选择读取方式                                       │
│    b. 判断是否为空文件/纯链接 → 跳过并记录日志                         │
│    c. 使用【知识提取模板】深度提取方法论                               │
│    d. 判断分类维度与跨平台适用性                                      │
├─────────────────────────────────────────────────────────────────┤
│ 6. 将提取的知识点插入汇总文档对应分类节点                              │
├─────────────────────────────────────────────────────────────────┤
│ 7. 更新 .processed_files.json                                      │
├─────────────────────────────────────────────────────────────────┤
│ 8. 输出处理报告                                                     │
└─────────────────────────────────────────────────────────────────┘
```

---

## 二、文件格式处理指南

### 支持的文件格式

| 格式 | 读取方式 | 优先级 |
|------|----------|--------|
| `.md` | 直接读取 view_file | 高 |
| `.txt` | 直接读取 view_file | 高 |
| `.html` | 直接读取 view_file，解析正文内容 | 高 |
| `.pdf` | 使用工具提取文本或直接读取 | 中 |
| `.doc/.docx` | 使用工具提取文本 | 中 |
| `.png/.jpg/.jpeg` | 使用视觉能力读取图片内容 | 中 |

### 空文件/纯链接判断标准

以下情况视为"空文件"，跳过处理并记录日志：
- 文件大小 < 100 字节
- 内容仅为 URL 链接（无实质正文）
- 内容仅为标题无正文
- HTML 文件正文提取后 < 50 字符

---

## 三、增量处理机制

### 处理记录文件位置

在目标文件夹的**根目录**创建/更新：`.processed_files.json`

### 记录格式

```json
{
  "metadata": {
    "last_run": "2026-01-13T14:00:00+08:00",
    "total_processed": 45,
    "template_used": "新媒体运营"
  },
  "files": {
    "01-小红书/爆款文案技巧.html": {
      "last_modified": "2026-01-10T10:30:00+08:00",
      "processed_at": "2026-01-12T14:00:00+08:00",
      "file_size": 15234,
      "status": "processed",
      "extracted_to": ["图文内容方法论", "小红书平台规则"]
    },
    "04-抖音/空文件.html": {
      "last_modified": "2026-01-08T09:00:00+08:00",
      "processed_at": "2026-01-12T14:00:00+08:00",
      "status": "skipped",
      "skip_reason": "空文件/纯链接"
    }
  }
}
```

### 增量判断逻辑

```
对于每个文件：
├── 不在记录中 → 新文件，需要处理
├── 在记录中但 status = "skipped" → 跳过
├── 在记录中且 文件修改时间 > processed_at → 内容更新，需要重新处理
└── 其他情况 → 跳过（已处理且未修改）
```

---

## 四、分类模板系统

### 模板选择优先级

1. **用户显式指定** `--模板:新媒体运营`
2. **检测已有汇总文件** 沿用其 Markdown 标题结构
3. **智能推断** 扫描样本文档，匹配内置模板
4. **兜底方案** 使用"通用知识"模板

### 内置模板

#### 模板1：新媒体运营

```markdown
# 方法论汇总

## 目录

---

## 按内容形式

### 图文内容方法论
（小红书、公众号、知乎等图文平台通用）

### 短视频方法论
（抖音、视频号、小红书视频等通用）

### 直播方法论

### 私域/社群运营方法论

---

## 按平台特性规则

### 小红书平台规则

### 抖音平台规则

### 公众号平台规则

### 视频号平台规则

### 其他平台规则

---

## 通用底层逻辑

### 流量运营底层逻辑

### IP打造底层逻辑

### 内容创作底层逻辑

### 用户心理与转化逻辑

### 知识管理方法论

---

## 处理日志

### 跳过的文件

### 最后更新时间
```

#### 模板2：植物养护

```markdown
# 植物知识汇总

## 目录

---

## 按植物类型

### 观叶植物

### 多肉植物

### 开花植物

### 果蔬种植

### 水培植物

---

## 按养护技术

### 浇水与湿度管理

### 光照需求

### 土壤与施肥

### 病虫害防治

### 繁殖方法（扦插/分株/播种）

### 修剪与造型

---

## 按应用场景

### 室内装饰植物

### 办公环境绿化

### 阳台园艺

### 庭院景观

### 租摆与商业绿植

---

## 处理日志

### 跳过的文件

### 最后更新时间
```

#### 模板3：通用知识（兜底）

```markdown
# 知识汇总

## 目录

---

## 核心概念

### 基础概念

### 进阶概念

---

## 方法与技巧

### 操作方法

### 实用技巧

### 最佳实践

---

## 案例与应用

### 成功案例

### 失败教训

### 应用场景

---

## 待分类

---

## 处理日志

### 跳过的文件

### 最后更新时间
```

---

## 五、知识提取模板

### 对每个文档提取以下要素

| 要素 | 说明 | 必填 |
|------|------|------|
| **方法论名称** | 核心策略的概括命名（简洁有力） | ✅ |
| **适用场景** | 什么情况下使用此方法 | ✅ |
| **核心框架** | 3-5 步可执行步骤或关键要点 | ✅ |
| **底层逻辑** | 为什么有效，背后的原理 | 可选 |
| **注意事项/风险提示** | 可能的坑、边界条件 | 可选 |
| **跨平台适用性** | 通用 / 平台特定 / 待确认 | ✅ |
| **来源文件** | 原始文件路径（便于溯源） | ✅ |

### 输出格式示例

```markdown
### 方法论名称："反向操作"引爆流量秘籍

**适用场景：** 抖音同城获客、本地实体店引流

**核心框架：**
1. **同城展示开启** - 激活区域性流量池，降低初始曝光门槛
2. **社交裂变三件套** - 开启推荐机制、授权通讯录、公开关注列表
3. **精准标签绑定** - 添加城市+行业标签引导算法推送
4. **地理位置锚定** - 添加热门商圈定位覆盖周边3-5公里

**底层逻辑：** 利用六人定律社交裂变原理，通过平台社交关联推荐算法实现精准人群的裂变式传播

**注意事项：** 过度依赖单一技巧可能导致账号标签混乱，建议结合内容质量进行系统性运营

**跨平台适用性：** 
- ✅ 通用：社交裂变逻辑可用于其他平台
- 📍 平台特定：同城推荐功能仅限抖音

**来源文件：** `04-抖音/反向操作技巧.html`
```

---

## 六、分类判断规则

### 判断分类维度的决策树

```
读取文档内容后：

1. 判断【内容形式】维度：
   ├── 涉及图文排版、文案写作 → 归入"图文内容方法论"
   ├── 涉及视频拍摄、剪辑、脚本 → 归入"短视频方法论"
   ├── 涉及直播技巧、话术 → 归入"直播方法论"
   ├── 涉及社群、私域、会员 → 归入"私域/社群运营方法论"
   └── 无法判断 → 跳过此维度

2. 判断【平台特性】维度：
   ├── 明确提及小红书规则/算法 → 归入"小红书平台规则"
   ├── 明确提及抖音规则/算法 → 归入"抖音平台规则"
   ├── 明确提及公众号规则 → 归入"公众号平台规则"
   ├── 明确提及视频号规则 → 归入"视频号平台规则"
   └── 无平台特定内容 → 跳过此维度

3. 判断【通用逻辑】维度：
   ├── 涉及流量获取底层原理 → 归入"流量运营底层逻辑"
   ├── 涉及个人品牌/人设 → 归入"IP打造底层逻辑"
   ├── 涉及内容创作通用技巧 → 归入"内容创作底层逻辑"
   ├── 涉及用户心理/转化 → 归入"用户心理与转化逻辑"
   └── 无法判断 → 归入"待分类"
```

### 一个文档可归入多个分类

如果一篇文档同时包含：
- 小红书图文写作技巧（内容形式 + 平台特性）
- 文案钩子通用原理（内容形式 + 通用逻辑）

则应该：
1. 在"图文内容方法论"下记录完整方法论
2. 在"小红书平台规则"下记录平台特定部分或引用链接
3. 在"内容创作底层逻辑"下记录通用原理部分

---

## 七、输出规范

### 汇总文档更新规则

1. **追加而非覆盖**：新提取的内容追加到对应分类下，不删除已有内容
2. **去重检查**：如果同名方法论已存在，跳过或更新（基于来源文件判断）
3. **保持格式一致**：严格遵循模板中的 Markdown 格式
4. **自动更新目录**：如有新增分类节点，同步更新目录部分

### 处理报告格式

每次执行完成后，输出以下报告：

```markdown
## 📊 知识提取处理报告

**处理时间：** 2026-01-13 14:30:00
**目标文件夹：** /path/to/folder
**使用模板：** 新媒体运营

### 处理统计

| 项目 | 数量 |
|------|------|
| 扫描文件总数 | 45 |
| 本次处理 | 12 |
| 跳过（已处理） | 30 |
| 跳过（空文件） | 3 |

### 新增方法论清单

1. ✅ "反向操作"引爆流量秘籍 → 短视频方法论、抖音平台规则
2. ✅ 五张主图法详情页设计 → 图文内容方法论
3. ...

### 跳过的文件

| 文件 | 原因 |
|------|------|
| 13-内容创作/链接收藏.html | 空文件/纯链接 |
| ... | ... |

### 汇总文件已更新

- `方法论汇总.md` ✅
- `.processed_files.json` ✅
```

---

## 八、错误处理与边界情况

### 静默处理规则

| 情况 | 处理方式 | 日志记录 |
|------|----------|----------|
| 文件无法读取 | 跳过，继续下一个 | 记录文件名和错误原因 |
| 空文件/纯链接 | 跳过，继续下一个 | 记录文件名，标记为 skipped |
| 无法识别文件格式 | 跳过，继续下一个 | 记录文件名 |
| 文档无明确方法论 | 尝试提取摘要，如无价值则跳过 | 记录文件名 |
| 分类无法判断 | 归入"待分类"节点 | 正常处理 |
| 汇总文件不存在 | 自动创建 | 正常处理 |
| .processed_files.json 不存在 | 自动创建 | 正常处理 |

### 绝对禁止的行为

❌ 不要问"是否继续处理下一个文件"
❌ 不要问"这个分类是否正确"
❌ 不要因为单个文件错误而停止整个流程
❌ 不要输出"我需要更多信息才能继续"

---

## 九、示例对话

### ✅ Good Case（正确执行）

**用户：** 帮我整理一下 /Users/dj/Desktop/小静的skills/notes/01-小红书 这个文件夹的知识文档

**Claude：** （静默执行完整流程，最后输出）

```markdown
## 📊 知识提取处理报告

**处理时间：** 2026-01-13 14:30:00
**目标文件夹：** /Users/dj/Desktop/小静的skills/notes/01-小红书
**使用模板：** 新媒体运营（检测到已有汇总文件）

### 处理统计
| 项目 | 数量 |
|------|------|
| 扫描文件总数 | 66 |
| 本次处理 | 15 |
| 跳过（已处理） | 48 |
| 跳过（空文件） | 3 |

### 新增方法论清单
1. ✅ 小红书爆款钩子10大类型 → 图文内容方法论、小红书平台规则
2. ✅ 笔记收藏率提升技巧 → 图文内容方法论
...

汇总文件已更新：`方法论汇总.md` ✅
```

### ❌ Anti-Pattern（错误示例 - 禁止）

**用户：** 帮我整理一下这个文件夹的知识文档

**Claude（错误）：**
> 好的，我发现这个文件夹有 66 个文件。请问您希望我：
> 1. 全部处理
> 2. 只处理最新的
> 3. 让我先看几个样本确认方向？

**为什么错误：** 中途询问打断了自动化流程。应该直接按照增量机制处理全部新增/更新文件。

---

## 十、扩展与维护

### 添加新模板

如需添加新领域模板，在本文件的【内置模板】章节按相同格式添加。

### 调整提取深度

如需调整提取要素，修改【知识提取模板】章节的表格。

### 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| 1.0 | 2026-01-13 | 初始版本，支持新媒体运营和植物养护模板 |
