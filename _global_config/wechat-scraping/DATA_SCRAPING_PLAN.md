# 微信公众号数据抓取完整方案

**更新时间**: 2026-02-05
**项目状态**: 基本信息已完成，统计数据和合集信息待执行

---

## 📊 三种数据类型总览

### 1. 基本信息 ✅ 已完成
**数据文件**: `wechat_articles_data.json`
**数据量**: 39篇活跃文章
**包含字段**:
- `title`: 文章标题
- `url`: 文章链接
- `publishTime`: 发布时间
- `isOriginal`: 是否原创
- `extractedAt`: 抓取时间戳

**抓取方式**: Playwright MCP 直接提取

---

### 2. 统计数据 ⏳ 待执行
**推荐方式**: 使用微信后台的"数据分析"功能下载Excel

**数据字段**（预期）:
- 阅读数 (views)
- 点赞数 (likes)
- 分享数 (shares)
- 收藏数 (favorites)
- 评论数 (comments)
- 划线数 (underlines)
- 打赏金额 (reward)
- 转载数 (reprints)

**执行步骤**:
1. 登录微信公众号后台
2. 点击左侧菜单"数据分析" → "内容分析" → "已发表内容"
3. 选择时间范围（建议"最近30天"或自定义）
4. 点击"下载数据明细"按钮
5. 下载的Excel文件包含所有文章的详细统计数据

**录制文件**: `recorded_data_analysis_workflow.js`

**优势**:
- ✅ 数据完整准确（官方导出）
- ✅ 包含所有统计维度
- ✅ 格式规范（Excel）
- ✅ 无需复杂的页面抓取

---

### 3. 合集信息 ⏳ 待执行
**数据来源**: 微信后台"合集"页面

**已识别的合集**（共10个）:
1. 绿植软装
2. 欣赏
3. 节气与绿植
4. 年宵花
5. 养护技巧
6. 修剪整形
7. 城市绿洲
8. 知识分享
9. 阳台种植
10. #智能园艺

**执行步骤**:
1. 登录微信公众号后台
2. 点击左侧菜单"内容管理" → "合集"
3. 查看合集列表
4. 点击每个合集查看包含的文章
5. 手动记录或使用Playwright MCP提取

**录制文件**: `recorded_collections_workflow.js`

**数据结构**（建议）:
```json
{
  "collections": [
    {
      "name": "绿植软装",
      "articles": ["文章标题1", "文章标题2", ...]
    },
    ...
  ]
}
```

---

## 🎯 推荐执行方案

### 方案A：混合方式（推荐）

**优势**: 结合自动化和官方数据，效率最高

1. **基本信息** ✅ 已完成
   - 使用Playwright MCP自动抓取
   - 数据文件: `wechat_articles_data.json`

2. **统计数据** 📥 手动下载
   - 使用微信后台"数据分析"功能
   - 下载Excel文件
   - 导入到飞书表格

3. **合集信息** 🤖 自动抓取或手动整理
   - 文章数量不多（39篇）
   - 可以手动整理合集归属
   - 或使用Playwright MCP自动提取

---

## 📁 文件清单

### 已生成的文件
- ✅ `wechat_articles_data.json` - 基本信息（39篇文章）
- ✅ `recorded_data_analysis_workflow.js` - 数据分析页面录制
- ✅ `recorded_collections_workflow.js` - 合集页面录制
- ✅ `wechat-scraping-progress.md` - 项目进度文档

### 待生成的文件
- ⏳ `wechat_articles_statistics.xlsx` - 统计数据（从微信后台下载）
- ⏳ `wechat_articles_collections.json` - 合集信息

---

## 🚀 下一步行动

### 立即可做的3件事

**1. 下载统计数据（5分钟）**
- 打开微信公众号后台
- 数据分析 → 内容分析 → 已发表内容
- 下载数据明细Excel
- 保存到项目目录

**2. 整理合集信息（10分钟）**
- 打开微信公众号后台
- 内容管理 → 合集
- 记录每个合集包含的文章
- 创建JSON文件

**3. 同步到飞书（15分钟）**
- 将三种数据整合
- 导入到飞书表格
- 建立字段映射关系

---

## 💡 关键发现

1. **统计数据最佳方案**: 直接使用微信后台的Excel导出功能，比页面抓取更可靠
2. **合集数量**: 共10个合集，覆盖不同主题
3. **文章总数**: 39篇活跃文章（已排除7篇已删除文章）

---

**状态**: 📋 方案已制定，等待执行
**下一步**: 下载统计数据Excel文件
