# Topic Discovery Skill v4.0 优化日志

## 🎯 优化目标（5个核心需求）

### 1. ✅ 选题输出到飞书多维表格
- **需求**：选题生成后放到飞书多维表格（慢养四季运营数据库 > 选题清单）
- **状态**：待实现
- **说明**：不再保存到本地 `/选题库/` 目录

### 2. ⚠️ 选题必须明确痛点
- **需求**：每个选题必须写清针对的用户痛点
- **目的**：指导下一步内容生成的角度
- **状态**：待实现

### 3. ⚠️ 起号阶段互动策略
- **需求**：虽然不直接推荐商品，但要让读者主动问"有没有推荐"
- **目标**：产生有效互动
- **状态**：待实现

### 4. ✅ GPT Research MCP 备用 API 配置
- **需求**：为 gptr-mcp 增加云雾平台备用 API
- **状态**：**已完成** ✅
- **完成时间**：2026-02-06
- **详情**：
  - 已配置多 API provider 支持
  - Primary: OpenAI (待用户配置)
  - Fallback: 云雾平台（已配置）
  - 自动切换机制已实现
  - 文档已更新：`CONFIGURATION_STATUS.md`
  - **v2.1 修复**：修复了 llm_provider 参数冲突问题，改用环境变量动态切换

### 5. ⚠️ 商品推荐进入飞书商品库
- **需求**：推荐的商品要符合飞书商品库表格格式
- **状态**：待实现
- **说明**：起号阶段（0-500粉）需要生成商品建议，而不是从现有商品库匹配

---

## 📝 当前进度

### 已完成
- [x] GPT Research MCP 多 API provider 配置（需求4）
  - 创建 `.env` 文件
  - 创建 `api_config.py`
  - 修改 `server.py` 集成 fallback 机制
  - 更新 `CONFIGURATION_STATUS.md`
  - 添加到 Claude Code 的 mcp.json

### 待完成（按 superpowers:writing-skills 方法）
- [ ] **Step 1: RED Phase - 写失败测试**
  - 创建压力场景测试当前 v4.0 的问题
  - 记录 baseline 行为（没有优化时的表现）
  - 识别具体的失败模式

- [ ] **Step 2: GREEN Phase - 写最小化 Skill**
  - 针对 baseline 失败，更新 SKILL.md
  - 实现需求 1, 2, 3, 5
  - 确保 Step 2 使用 GPT Research MCP 的 deep_research

- [ ] **Step 3: REFACTOR Phase - 关闭漏洞**
  - 测试新版本
  - 识别新的合理化借口
  - 添加明确的反驳
  - 重新测试直到防弹

---

## 🔄 下一步行动

**重启后应该继续的任务**：

1. **开始 RED Phase**（按照 superpowers:writing-skills）
   - 创建压力场景
   - 测试当前 v4.0 的 baseline 行为
   - 记录失败模式

2. **注意事项**：
   - MCP 配置已完成，但需要重启 Claude Code 才能生效
   - 重启后可以直接使用 `mcp__gptr-mcp__deep_research` 工具
   - 不需要在 skill 中处理 API 切换逻辑

---

## 📌 重要上下文

### 账号阶段
- **当前阶段**：起号期（0-500粉）
- **商品策略**：
  - ❌ 不从现有商品库匹配（商品库是空的）
  - ✅ 从选题中提取商品需求，生成商品建议
  - ✅ 商品建议必须符合飞书商品库表格格式
  - ✅ 优先推荐周边品（容器、基质、养护、工具）> 绿植

### 核心原则
- 选题即选品：每个选题都要分析商品需求
- 痛点驱动：选题必须明确用户痛点
- 互动导向：起号阶段要引导用户主动询问

---

## 🔗 相关文件

- **Skill 文件**：`/Users/dj/Desktop/小静的skills/topic-discovery/SKILL.md`
- **MCP 配置**：`/Users/dj/Desktop/小静的skills/gptr-mcp/`
- **账号配置**：`~/.claude/CLAUDE.md` (多平台账号配置部分)
- **飞书 MCP**：已安装，可用于写入飞书表格

---

**最后更新**：2026-02-06
**当前版本**：v4.0（待优化）
**目标版本**：v4.1（完成5个需求）
